<template>
    <!-- HERO -->
    <section class="hero">
        <div class="hero-overlay"></div>

        <div class="hero-inner">
            <h1 class="hero-title fade-in">
                Find Your <span>Perfect Property</span>
            </h1>
            <p class="hero-subtitle fade-in">
                Buy, Rent or Invest — curated homes just for you
            </p>

            <!-- SEARCH CARD -->
            <div class="search-glass fade-in">
                <div class="slds-grid slds-gutters_medium">
                    <div class="slds-col">
                        <lightning-combobox
                            label="Property Type"
                            value={propertyType}
                            options={propertyTypeOptions}
                            onchange={handlePropertyTypeChange}>
                        </lightning-combobox>
                    </div>

                    <div class="slds-col">
                        <lightning-input
                            label="Location"
                            type="text"
                            data-id="location"
                            value={location}
                            onchange={handleLocationChange}
                            placeholder="City or Locality"
                            required>
                        </lightning-input>
                    </div>

                    <div class="slds-col slds-align-bottom">
                        <lightning-button
                            label="Search Properties"
                            variant="brand"
                            icon-name="utility:search"
                            onclick={handleSearch}
                            class="search-btn">
                        </lightning-button>
                    </div>
                </div>

                <!-- RECENT -->
                <div class="recent">
                    <span>Recent:</span>
                    <template for:each={recentSearches} for:item="search">
                        <button key={search}
                                class="recent-chip"
                                onclick={handleRecentSearch}>
                            {search}
                        </button>
                    </template>
                </div>
            </div>
        </div>
    </section>

    <!-- RESULTS -->
    <section class="content">
        <h2 class="section-title">
            Properties in <span>{searchedCity}</span>
        </h2>

        <div class="property-grid">
            <template for:each={displayedProperties} for:item="property">
                <article key={property.propertyData.Id}
                         class="property-card slide-in"
                         data-id={property.propertyData.Id}
                         onclick={navigateToPropertyDetail}>

                    <div class="image-wrapper">
                        <img src={property.ImageUrl}
                             data-id={property.propertyData.Id}
                             onerror={handleImageError}/>
                        <span class="price-chip">
                            ₹{property.propertyData.Price__c}
                        </span>
                    </div>

                    <div class="card-body">
                        <h3>{property.propertyData.Name}</h3>
                        <p class="address">
                            {property.propertyData.Address__c}
                        </p>

                        <div class="meta">
                            <span>{property.Bedrooms}</span>
                            <span>{property.propertyData.Property_Type__c}</span>
                        </div>

                        <div class="actions">
                            <lightning-button
                                label="Interest"
                                variant="brand"
                                data-id={property.propertyData.Id}
                                onclick={handleExpressInterest}>
                            </lightning-button>

                            <lightning-button
                                label="Owner"
                                variant="neutral"
                                data-id={property.propertyData.Id}
                                onclick={handleContactOwner}>
                            </lightning-button>
                        </div>
                    </div>
                </article>
            </template>
        </div>

        <!-- EMPTY -->
        <template if:true={noResultsMessage}>
            <div class="empty-state">
                <p>{noResultsMessage}</p>
                <blockquote>
                    “The best investment on Earth is Earth.”
                </blockquote>
            </div>
        </template>

        <!-- SHOW MORE -->
        <template if:true={showMoreVisible}>
            <div class="center">
                <lightning-button
                    label="Load More"
                    onclick={handleShowMore}>
                </lightning-button>
            </div>
        </template>
    </section>
</template>
